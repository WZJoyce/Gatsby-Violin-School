{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import {\n  jsx as emotion,\n  ThemeContext as EmotionContext,\n  InterpolationWithTheme,\n} from '@emotion/core'\nimport { css, Theme } from '@theme-ui/css'\nimport * as React from 'react'\nimport deepmerge from 'deepmerge'\nimport packageInfo from '@emotion/core/package.json'\n\nimport './react-jsx'\n\nexport type {\n  CSSObject,\n  CSSOthersObject,\n  CSSProperties,\n  CSSPseudoSelectorProps,\n  ColorMode,\n  ColorModesScale,\n  Label,\n  ResponsiveStyleValue,\n  Scale,\n  StylePropertyValue,\n  TLengthStyledSystem,\n  Theme,\n  ThemeDerivedStyles,\n  ThemeStyles,\n  ThemeUICSSObject,\n  ThemeUICSSProperties,\n  ThemeUIExtendedCSSProperties,\n  ThemeUIStyleObject,\n  VariantProperty,\n} from '@theme-ui/css'\nexport * from './types'\n\nconst __EMOTION_VERSION__ = packageInfo.version\n\nconst getCSS = (props) => {\n  if (!props.sx && !props.css) return undefined\n  return (theme) => {\n    const styles = css(props.sx)(theme)\n    const raw = typeof props.css === 'function' ? props.css(theme) : props.css\n    return [styles, raw]\n  }\n}\n\nconst parseProps = (props) => {\n  if (!props) return null\n  const next: typeof props & { css?: InterpolationWithTheme<any> } = {}\n  for (let key in props) {\n    if (key === 'sx') continue\n    next[key] = props[key]\n  }\n  const css = getCSS(props)\n  if (css) next.css = css\n  return next\n}\n\nexport const jsx: typeof React.createElement = (type, props, ...children) =>\n  emotion.apply(undefined, [type, parseProps(props), ...children])\n\nexport interface ContextValue {\n  __EMOTION_VERSION__: string\n  theme: Theme\n}\n\nexport const Context = React.createContext<ContextValue>({\n  __EMOTION_VERSION__,\n  theme: {},\n})\n\nexport const useThemeUI = () => React.useContext(Context)\n\nconst canUseSymbol = typeof Symbol === 'function' && Symbol.for\n\nconst REACT_ELEMENT = canUseSymbol ? Symbol.for('react.element') : 0xeac7\nconst FORWARD_REF = canUseSymbol ? Symbol.for('react.forward_ref') : 0xeac7\n\nconst isMergeableObject = (n) => {\n  return (\n    !!n &&\n    typeof n === 'object' &&\n    n.$$typeof !== REACT_ELEMENT &&\n    n.$$typeof !== FORWARD_REF\n  )\n}\n\nconst arrayMerge = (destinationArray, sourceArray, options) => sourceArray\n\n/**\n * Deeply merge themes\n */\nexport const merge = (a: Theme, b: Theme): Theme =>\n  deepmerge(a, b, { isMergeableObject, arrayMerge })\n\nfunction mergeAll<A, B>(a: A, B: B): A & B\nfunction mergeAll<A, B, C>(a: A, B: B, c: C): A & B & C\nfunction mergeAll<A, B, C, D>(a: A, B: B, c: C, d: D): A & B & C & D\nfunction mergeAll<T = Theme>(...args: Partial<T>[]) {\n  return deepmerge.all<T>(args, { isMergeableObject, arrayMerge })\n}\n\nmerge.all = mergeAll\n\ninterface BaseProviderProps {\n  context: ContextValue\n}\nconst BaseProvider: React.FC<BaseProviderProps> = ({ context, children }) =>\n  jsx(\n    EmotionContext.Provider,\n    { value: context.theme },\n    jsx(Context.Provider, {\n      value: context,\n      children,\n    })\n  )\n\nexport interface ThemeProviderProps {\n  theme: Theme | ((outerTheme: Theme) => Theme)\n  children?: React.ReactNode\n}\n\nexport function ThemeProvider({ theme, children }: ThemeProviderProps) {\n  const outer = useThemeUI()\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (outer.__EMOTION_VERSION__ !== __EMOTION_VERSION__) {\n      console.warn(\n        'Multiple versions of Emotion detected,',\n        'and theming might not work as expected.',\n        'Please ensure there is only one copy of @emotion/core installed in your application.'\n      )\n    }\n  }\n\n  const context =\n    typeof theme === 'function'\n      ? { ...outer, theme: theme(outer.theme) }\n      : merge.all({}, outer, { theme })\n\n  return jsx(BaseProvider, { context }, children)\n}\n"],"names":["__EMOTION_VERSION__","packageInfo","version","getCSS","props","sx","css","undefined","theme","styles","raw","parseProps","next","key","jsx","type","emotion","apply","Context","React","useThemeUI","canUseSymbol","Symbol","REACT_ELEMENT","FORWARD_REF","isMergeableObject","n","$$typeof","arrayMerge","destinationArray","sourceArray","options","merge","a","b","deepmerge","mergeAll","all","BaseProvider","context","children","EmotionContext","Provider","value","ThemeProvider","outer","process","env","NODE_ENV","console","warn"],"mappings":"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"}